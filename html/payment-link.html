<h1>Payment Link</h1>
<p>
  You can use the Payment Link API to generate links to our <a href="/payment-window">payment window</a>, where your customers can enter their payment details. You can either redirect the customer to the payment window, or you can embed the window in your website or app.
</p>
<p>
  The API is fault-tolerant and forgiving. Invalid data will generally be ignored, and there are no required fields. Here is a minimal example in pseudocode.
</p>

<pre class="responsive"><code class="code--block">{% include "code/paylink/pseudo.html" %}</code></pre>

<p>
  The response is a JSON object containing the payment link URL.
</p>
z
<h3 id="request-headers">Request Headers</h3>
<p>
  The request endpoint is: <code class="code--inline">https://api.scanpay.dk/v1/new</code>. Requests are authenticated with HTTP basic authentication.
</p>


<div class="table--responsive">
  <table>
    <thead>
      <tr>
        <th>HTTP/1.1 headers</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
      <tr>
        <td>
          <code class="code--tmp ellipsis"><span class="hljs-attribute">Authorization</span>: Basic MTE1MzpZSFpJVUdRdzZOa0NJWWEzbUc2Q1djZ1NobmwxM3h1STdPREZVWXVNeTBqNzkwUTZUaHdCRWp4ZldGWHdKWjBX</code>
        </td>
        <td>
          Basic authentication, where your credentials <i>(shopid:secret)</i> are in the API key, so you only have to base64 encode the API key.
        </td>
      </tr>
      <tr>
        <td>
          <code class="code--tmp"><span class="hljs-attribute">X-Cardholder-IP</span>: 47.105.175.99</code>
        </td>
        <td>
          The IPv4 or IPv6 address of the customer. This is used for DoS protection and it is optional.
        </td>
      </tr>
    </tbody>
  </table>
</div>


<h3 id="request-fields">Request Fields</h3>
<p>
  There is a maximum request size limit of 32 kB.
</p>

<div class="table--responsive">
  <table>
    <thead>
      <tr>
        <th>JSON fields</th>
        <th>Description</th>
      </tr>
    </thead>

    <tbody>
      <tr>
        <td>
          <pre><code class="code--tmp code--ellipsis">{% include "code/paylink/items.json" %}</code></pre>
        </td>
        <td>
          An array with items.
          <ul class="table--ul">
            <li><b>name:</b> The name of the item.</li>
            <li><b>quantity:</b> The number of items (integer).</li>
            <li>
              <b>total:</b> The line total (i.e. unit-price x quantity) with an ISO 4217 currency code.
            </li>
            <li>
              <b>sku:</b> A <a rel="nofollow" href="//en.wikipedia.org/wiki/Stock_keeping_unit">SKU</a> for this particular product.
            </li>
          </ul>
          <span class="td--note">
            In this example the grand total is 13397.9986 DKK. Most acquires only support 2 digits after the decimal point. If this is the case we will truncate to 13397.99.
          </span>
        </td>
      </tr>
      <tr>
        <td>
          <pre><code class="code--tmp code--ellipsis">{% include "code/paylink/billing.json" %}</code></pre>
        </td>
        <td>
          Customer billing and shipping address. The information is used for fraud detection and it is displayed in our dashboard.

          <ul class="table--ul">
            <li><b>company:</b> Company legal name.</li>
            <li><b>vatin:</b> EU VAT identification number with country prefix.</li>
            <li><b>gln:</b> Global Location Number or European Article Numbering (EAN-number).</li>
            <li><b>phone:</b> Phone number with country prefix.</li>
            <li><b>address:</b> An address array where each element is a new line.</li>
            <li><b>zip:</b> Postal code.</li>
            <li><b>country:</b> Two-letter country code (<a rel="nofollow" href="//en.wikipedia.org/wiki/ISO_3166-1_alpha-2#Officially_assigned_code_elements">ISO 3166-1</a>).</li>
          </ul>
        </td>
      </tr>

      <tr>
        <td>
          <code class="code--tmp"><span class="hljs-attr">"orderid"</span>: <span class="hljs-string">"1234zx"</span></code>
        </td>
        <td>
          The actual order ID is sent to your acquirer and it is displayed in the payment window.
        </td>
      </tr>
      <tr>
        <td>
          <code class="code--tmp"><span class="hljs-attr">"successurl"</span>: <span class="hljs-string">"http://blixen.dk/success"</span></code>
        </td>
        <td>
          Redirect to this URL after succesful payment. If omitted we will show a generic success message.
        </td>
      </tr>

      <tr>
        <td>
          <code class="code--tmp"><span class="hljs-attr">"language"</span>: <span class="hljs-string">"da"</span></code>
        </td>
        <td>
          Payment window language in ISO 639-1. Here is what <a href="/payment-window#languages">we support</a>. Fallback is the browser language.
        </td>
      </tr>
      <tr>
        <td>
          <code class="code--tmp"><span class="hljs-attr">"autocapture"</span>: <span class="hljs-number">true</span></code>
        </td>
        <td>
          Automatically capture the payment. Default is <code class="code--inline hljs-number">false</code>.
        </td>
      </tr>
      <tr>
        <td>
          <code class="code--tmp"><span class="hljs-attr">"lifetime"</span>: <span class="hljs-string">"7d"</span></code>
        </td>
        <td>
          Payment link lifetime in days <i>(<span class="hljs-string">"d"</span>)</i>, hours <i>(<span class="hljs-string">"h"</span>)</i> or minutes <i>(<span class="hljs-string">"m"</span>)</i>. Default is <code class="code--inline hljs-string">"1h"</code> and max is <code class="code--inline hljs-string">"30d"</code>. Increasing the lifetime will also increase the length of the payment link URL.
        </td>
      </tr>
    </tbody>
  </table>
</div>


<h3 id="mobilepay">Link Parameters</h3>
<p>
  The following link parameters can be appended to the payment link:
</p>


<div class="table--responsive">
  <table>
    <thead>
      <tr>
        <th>Link parameter</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
      <tr>
        <td>
        <code class="code--tmp"><span class="hljs-string">?iframe</span></code>
        </td>
        <td>
          Embed the payment window in your website or app with an iFrame. You will have to enable this feature in our dashboard.
        </td>
      </tr>
        <td>
          <code class="code--tmp"><span class="hljs-string">?go=mobilepay</span></code>
        </td>
        <td>
          Redirect the customer to MobilePay Online. You need to enable MobilePay <a href="https://dashboard.scanpay.dk/settings/acquirers">here</a>.
        </td>
      </tr>
    </tbody>
  </table>
</div>

<hr>

<h2 id="response-fields">Response</h2>

<h3 id="response-fields">Response Fields</h3>
<p>
  Successful responses have a <code class="code--inline">200</code> status code with the following JSON field:
</p>

<div class="responsive">
  <table>
    <thead>
      <tr>
        <th>JSON field</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
      <tr>
        <td>
          <code class="code--tmp"><span class="hljs-attr">"url"</span>: <span class="hljs-string">"https://betal.scanpay.dk/9qdvbx2r"</span></code>
        </td>
        <td>The returned payment link.</td>
      </tr>
    </tbody>
  </table>
</div>


<h3 id="request-errors">Errors</h3>

<p>
  The API is designed to be fault-tolerant and forgiving.
</p>

<div class="responsive" style="margin-top: 30px;">
  <table style="table-layout: auto;">
    <thead>
      <tr>
        <th>Code</th>
        <th>HTTP Body</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
      <tr>
        <td class="hljs-attr">400</td>
        <td>invalid json</td>
        <td>Invalid JSON.</td>
      </tr>

      <tr>
        <td class="hljs-attr">400</td>
        <td>missing items</td>
        <td>
          Missing <code class="code--inline hljs-attr">items</code> array.
        </td>
      </tr>

      <tr>
        <td class="hljs-attr">400</td>
        <td>invalid items.total</td>
        <td>
          Invalid or missing <code class="code--inline hljs-attr">total</code> field.
        </td>
      </tr>

      <tr>
        <td class="hljs-attr">403</td>
        <td>invalid apikey</td>
        <td>Invalid API key.</td>
      </tr>

      <tr>
        <td class="hljs-attr">408</td>
        <td>Request Timeout</td>
        <td>
          The request timed out after <code class="code--inline hljs-attribute">8</code> seconds.
        </td>
      </tr>

      <tr>
        <td class="hljs-attr">413</td>
        <td>Request Entity Too Large</td>
        <td>
          The request body was larger than <code class="code--inline hljs-attribute">32 kB</code>.
        </td>
      </tr>

      <tr>
        <td class="hljs-attr">400</td>
        <td>Request Header Or Cookie Too Large</td>
        <td>
          The request HTTP headers were larger than <code class="code--inline hljs-attribute">4 kB</code>
        </td>
      </tr>

      <tr>
        <td class="hljs-attr">500</td>
        <td>internal server error</td>
        <td>
          Technical issue or scheduled downtime. Please try again.
        </td>
      </tr>
    </tbody>
  </table>
</div>

<hr>


<h2 id="examples">Examples</h2>
<p>
  Here are a few examples. We recommend that you take a look at our official <a href="/api-libraries">client libraries</a>.
</p>

<div class="responsive">
  <div class="code--example">
    <button data-lang="curl" data-file="paylink/newURL.bash.html" class="code--example--first code--example--active">Curl</button>
    <button data-lang="php" data-file="paylink/newURL.php">PHP</button>
    <button data-lang="node" data-file="paylink/newURL.js">Node</button>
    <button data-lang="go" data-file="paylink/newURL.go">Go</button>
    <button data-lang="rb" data-file="paylink/newURL.rb">Ruby</button>
    <button data-lang="net" data-file="paylink/newURL.cs">.NET</button>
    <pre><code class="" style="padding: 8px;">{% include "code/paylink/newURL.bash.html" %}</code></pre>
  </div>
</div>


<h1>Payment Window</h1>
<p>
  The payment window is a secure, hosted payment page that lets you collect payments quickly without worrying about PCI compliance.


   The payment window is accessible through <a href="/payment-link">payment links</a>. It is lightweight and thoroughly tested. The code is auditable, secure and stable. For security reasons, we do not use any third-party frameworks or services.
</p>

<h2 id="user-interaction">User interaction</h2>
<p>
  The payment window is optimized for computers and phones. We support autofill in accordance with the whatwg autofill <a href="https://html.spec.whatwg.org/multipage/forms.html#autofill">standard</a>.
</p>

<div class="pic-flex">
  <img class="pic enlarge" width="190" height="200" src="/a/img/payment-window.png" alt="Payment window">
  <img class="pic enlarge" width="145" height="200" src="/a/img/payment-window-phone.jpg" alt="Responsive payment window ">
</div>


<div class="responsive" style="margin-top: 30px;">
  <table>
    <tr style="text-align: center;">
      <th>Chrome</th>
      <th>Safari</th>
      <th>Safari on iOS</th>
      <th>Firefox</th>
      <th>Android <br>browser</th>
      <th>Edge</th>
      <th>Opera</th>
    </tr>
    <tr>
      <td>
        51<br>
        <small>2016-05</small>
      </td>
      <td>
        10.1<br>
        <small>2016-05</small>
      </td>
      <td>
        10.1<br>
        <small>2016-05</small>
      </td>
      <td>
        10.1<br>
        <small>2016-05</small>
      </td>
      <td>
        44<br>
        <small>2016-05</small>
      </td>
      <td>
        14<br>
        <small>2016-05</small>
      </td>
      <td>
        38<br>
        <small>2016-05</small>
      </td>
    </tr>
  </table>
</div>

<h2 id="customization">Customization</h2>
<p>
  We recommend that you upload your company logo in our <a href="https://dashboard.scanpay.dk/settings/payment-window">dashboard</a>.
</p>

<h2 id="languages">Languages</h2>
<p>
  When you create a <a href="/payment-link">payment link</a>, you can select the desired language for the payment window. Our fallback is to choose the best available language, depending on the customers browser settings, i.e. the <code class="code--inline">Accept-Language</code> header. Please contact us if you would like us to support a specific language. We currently support the following languages:
</p>

<div class="paywin--language--flex">
  <table>
    <thead>
      <tr>
        <th width="100">Language</th>
        <th>ISO 639-1</th>
        <th>Git</th>
      </tr>
    </thead>
    <tbody>
      <tr>
        <td>Danish</td>
        <td>da</td>
        <td>
          <a rel="nofollow" href="#">
            {% include "tpl/svg/payment-window/github_black.svg" %}
          </a>
        </td>
      </tr>
      <tr>
        <td>Swedish</td>
        <td>sv</td>
        <td>
          <a rel="nofollow" href="#">
            {% include "tpl/svg/payment-window/github_black.svg" %}
          </a>
        </td>
      </tr>
      <tr>
        <td>Norwegian</td>
        <td>no</td>
        <td>
          <a rel="nofollow" href="#">
            {% include "tpl/svg/payment-window/github_black.svg" %}
          </a>
        </td>
      </tr>
    </tbody>
  </table>

  <table>
    <thead>
      <tr>
        <th width="100">Language</th>
        <th>ISO 639-1</th>
        <th>Git</th>
      </tr>
    </thead>
    <tbody>
      <tr>
        <td>English</td>
        <td>en</td>
        <td>
          <a rel="nofollow" href="#">
            {% include "tpl/svg/payment-window/github_black.svg" %}
          </a>
        </td>
      </tr>
      <tr>
        <td>German</td>
        <td>de</td>
        <td>
          <a rel="nofollow" href="#">
            {% include "tpl/svg/payment-window/github_black.svg" %}
          </a>
        </td>
      </tr>
      <tr>
        <td>French</td>
        <td>fr</td>
        <td>
          <a rel="nofollow" href="#">
            {% include "tpl/svg/payment-window/github_black.svg" %}
          </a>
        </td>
      </tr>
    </tbody>
  </table>
</div>

