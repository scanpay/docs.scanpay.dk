<section>
  <h1 id="introduction">Payment Link</h1>

  <p>
    With the Payment Link API, you can generate links to our hosted <a href="#payment-window">payment window</a>, where customers can enter their payment details. Payment links are stateful and exist until expiration, defined by the <a href="#field-lifetime">lifetime</a> field.
  </p>
  <p>
    Here is a minimal example in pseudocode. You can find more examples in our <a href="/#client-libraries">client libraries</a>.
  </p>

  <pre class="responsive"><code class="code--block">{% include "code/paylink/pseudo.html" %}</code></pre>

  <p>
    Successful responses have a <code class="code--inline">200</code> status code and a JSON body containing the payment link:
  </p>

  <pre class="responsive"><code class="code--block">{% include "code/paylink/pseudo-response.html" %}</code></pre>

  <p>
    Invalid responses will return a <code class="code--inline">4XX</code> or <code class="code--inline">5XX</code> error code and an error message. See <a href="#">error handling</a> for more details.
  </p>

  <div class="pic-flex">
    <img class="pic enlarge" width="190" height="200" src="/a/img/payment-window.png" alt="Payment window">
    <img class="pic enlarge" width="145" height="200" src="/a/img/payment-window-phone.jpg" alt="Responsive payment window ">
  </div>

</section>

<section>
  <h2 id="create-link">Create payment link</h2>

  <p>
    The request endpoint is: <code class="code--inline">https://api.scanpay.dk/v1/new</code>.
  </p>

  <div class="table--responsive">
    <table>
      <thead>
        <tr>
          <th>HTTP header</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
        <tr>
          <td>
            {% include "code/paylink/auth-header.html" %}
          </td>
          <td>
            HTTP basic authentication with your API key as credentials, which you will need to base64 encode.
          </td>
        </tr>
        <tr>
          <td>
            <code class="code--tmp">
              <span class="hljs-attribute">X-Cardholder-IP</span>: 47.105.175.99
            </code>
          </td>
          <td>
            Customer IPv4 or IPv6 address. It is used for DoS protection, and it is optional but recommended.
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <h3 id="request-fields">Request Fields</h3>
  <p>
    The API is fault-tolerant and forgiving. Apart from <code class="code--inline">items</code>, all fields are optional, and we will ignore them if they are invalid. There is a maximum request size of 32 kB but no field size restrictions.
  </p>

  <div class="table--responsive">
    <table>
      <thead>
        <tr>
          <th>JSON fields</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
        <tr>
          <td>
            <pre><code class="code--tmp code--ellipsis">{% include "code/paylink/items.json" %}</code></pre>
          </td>
          <td>
            <p>
              An array with one or more items. Each item needs a <code class="code--inline">total</code>, but all other fields are optional.
            </p>

            <ul class="table--ul">
              <li><b>name:</b> the name of the item or service.</li>
              <li><b>quantity:</b> the number of items <i>(integer)</i>.</li>
              <li>
                <b>total:</b> line total, i.e. unit-price times quantity, with an ISO 4217 currency code.
              </li>
              <li>
                <b>sku:</b> a <a rel="nofollow" href="//en.wikipedia.org/wiki/Stock_keeping_unit">SKU</a> for this particular item.
              </li>
            </ul>
            <span class="td--note">
              In this example, the total amount is 13497.9986 DKK. Most acquires only support two or three digits after the decimal point. We will automatically truncate the value if needed.
            </span>
          </td>
        </tr>
        <tr>
          <td>
            <pre><code class="code--tmp code--ellipsis">{% include "code/paylink/billing.json" %}</code></pre>
          </td>
          <td>
            <p>
              Customer billing and shipping address. We use it to protect your business against fraud, and we show the details in our dashboard.
            </p>

            <ul class="table--ul">
              <li>
                <b>company:</b> Company legal name.
              </li>
              <li>
                <b>vatin:</b> EU VAT identification number with country prefix.
              </li>
              <li>
                <b>gln:</b> Global Location Number or European Article Numbering (EAN-number).
              </li>
              <li>
                <b>phone:</b> Phone number with country prefix.
              </li>
              <li>
                <b>address:</b> An address array where each element is a new line.
              </li>
              <li>
                <b>zip:</b> Postal code.
              </li>
              <li>
                <b>country:</b> Two-letter country code (<a rel="nofollow" href="//en.wikipedia.org/wiki/ISO_3166-1_alpha-2#Officially_assigned_code_elements">ISO 3166-1</a>).
              </li>
            </ul>
          </td>
        </tr>

        <tr>
          <td>
            <code class="code--tmp"><span class="hljs-attr">"orderid"</span>: <span class="hljs-string">"1234zx"</span></code>
          </td>
          <td>
            An order identifier that identifies the order in your system. We send the ID to your acquirer and display it in the payment window.
          </td>
        </tr>
        <tr>
          <td>
            <code class="code--tmp"><span class="hljs-attr">"successurl"</span>: <span class="hljs-string">"http://blixen.dk/success"</span></code>
          </td>
          <td>
            The success URL is where we send the customer after successful payment.
          </td>
        </tr>

        <tr>
          <td>
            <code class="code--tmp"><span class="hljs-attr">"language"</span>: <span class="hljs-string">"da"</span></code>
          </td>
          <td>
            The desired payment window language in ISO <a href="https://en.wikipedia.org/wiki/ISO_639-1">639-1</a>. Default is the browser language.
          </td>
        </tr>
        <tr>
          <td>
            <code class="code--tmp"><span class="hljs-attr">"autocapture"</span>: <span class="hljs-number">true</span></code>
          </td>
          <td>
            Automatically capture the payment. Default is <code class="code--inline hljs-number">false</code>, which means that payments are authorized <i>(reserved)</i>, but not captured.
          </td>
        </tr>
        <tr id="field-lifetime">
          <td>
            <code class="code--tmp"><span class="hljs-attr">"lifetime"</span>: <span class="hljs-string">"7d"</span></code>
          </td>
          <td>
            Payment link lifetime in days <i>(<span class="hljs-string">"d"</span>)</i>, hours <i>(<span class="hljs-string">"h"</span>)</i> or minutes <i>(<span class="hljs-string">"m"</span>)</i>. Default is <code class="code--inline hljs-string">"1h"</code> and max is <code class="code--inline hljs-string">"30d"</code>. Increasing the lifetime will also increase the length of the returned URL.
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <h3 id="mobilepay">Link Parameters</h3>
  <p>
    The following link parameters can be appended to the payment link:
  </p>

  <div class="table--responsive">
    <table>
      <thead>
        <tr>
          <th>Link parameter</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <td>
            <code class="code--tmp"><span class="hljs-string">?go=mobilepay</span></code>
          </td>
          <td>
            Redirect the customer to MobilePay Online. You need to enable MobilePay Online <a href="https://dashboard.scanpay.dk/settings/acquirers">here</a>.
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <h3 id="languages">Languages</h3>
  <p>
    When you create a payment link, you can select the desired language for the payment window. Our fallback is to choose the best available language, depending on the customers browser settings, i.e. the <code class="code--inline">Accept-Language</code> header. We currently support the following languages:
  </p>

  <div class="paywin--language--flex">
    <table style="width: auto; min-width: 0;">
      <thead>
        <tr>
          <th style="width: 7rem;">Language</th>
          <th>ISO 639-1</th>
          <th>Git</th>
        </tr>
      </thead>
      <tbody>
        <tr>
          <td>Danish</td>
          <td>da</td>
          <td>
            <a rel="nofollow" href="#">
              {% include "tpl/svg/payment-window/github_black.svg" %}
            </a>
          </td>
        </tr>
        <tr>
          <td>Swedish</td>
          <td>sv</td>
          <td>
            <a rel="nofollow" href="#">
              {% include "tpl/svg/payment-window/github_black.svg" %}
            </a>
          </td>
        </tr>
        <tr>
          <td>Norwegian</td>
          <td>no</td>
          <td>
            <a rel="nofollow" href="#">
              {% include "tpl/svg/payment-window/github_black.svg" %}
            </a>
          </td>
        </tr>
      </tbody>
    </table>
    <table style="width: auto; min-width: 0;">
      <thead>
        <tr>
          <th style="width: 7rem;">Language</th>
          <th>ISO 639-1</th>
          <th>Git</th>
        </tr>
      </thead>
      <tbody>
        <tr>
          <td>English</td>
          <td>en</td>
          <td>
            <a rel="nofollow" href="#">
              {% include "tpl/svg/payment-window/github_black.svg" %}
            </a>
          </td>
        </tr>
        <tr>
          <td>German</td>
          <td>de</td>
          <td>
            <a rel="nofollow" href="#">
              {% include "tpl/svg/payment-window/github_black.svg" %}
            </a>
          </td>
        </tr>
        <tr>
          <td>French</td>
          <td>fr</td>
          <td>
            <a rel="nofollow" href="#">
              {% include "tpl/svg/payment-window/github_black.svg" %}
            </a>
          </td>
        </tr>
      </tbody>
    </table>
  </div>
</section>

<section>
  <h2 id="payment-window">Payment Window</h2>
  <p>
    The payment window is a secure, hosted payment page that lets you collect payments quickly without worrying about PCI compliance. The payment window is accessible through <a href="/payment-link">payment links</a>.

  <h3 id="user-interaction">User interaction</h3>
  <p>
    The payment window is optimized for computers and phones. We support autofill in accordance with the whatwg autofill <a href="https://html.spec.whatwg.org/multipage/forms.html#autofill">standard</a>.
  </p>

  <div class="pic-flex">
    <img class="pic enlarge" width="190" height="200" src="/a/img/payment-window.png" alt="Payment window">
    <img class="pic enlarge" width="145" height="200" src="/a/img/payment-window-phone.jpg" alt="Responsive payment window ">
  </div>

  <div class="table--responsive">
    <table>
      <tr style="text-align: center;">
        <th>Chrome</th>
        <th>Safari</th>
        <th>Safari on iOS</th>
        <th>Firefox</th>
        <th>Android <br>browser</th>
        <th>Edge</th>
        <th>Opera</th>
      </tr>
      <tr>
        <td>
          51<br>
          <small>2016-05</small>
        </td>
        <td>
          10.1<br>
          <small>2016-05</small>
        </td>
        <td>
          10.1<br>
          <small>2016-05</small>
        </td>
        <td>
          10.1<br>
          <small>2016-05</small>
        </td>
        <td>
          44<br>
          <small>2016-05</small>
        </td>
        <td>
          14<br>
          <small>2016-05</small>
        </td>
        <td>
          38<br>
          <small>2016-05</small>
        </td>
      </tr>
    </table>
  </div>

</section>


