<h1>Security at Scanpay</h1>

<p>
  We have built our system from the ground up, with a security by design approach, making security considerations the core of our engineering process. You can therefore rest assured that we have implemented multiple layers of security to protect your data.
</p>

<p>
  If you have any questions or concerns, please do not hesitate to <a target="_blank" href="mailto:security@scanpay.dk">contact us</a>.
</p>

<section>
  <h2 id="data-protection">Data protection</h2>
  <p>
    We are fully compliant with the General Data Protection Regulation (GDPR) and the Payment Card Industry Data Security Standard (PCI DSS).<sup><a href="#ref-1">[1]</a></sup> Sensitive data is encrypted with AES-256-GCM and stored in multiple data centers within the European Union. The encryption key is protected with <a target="_blank" href="https://en.wikipedia.org/wiki/Shamir%27s_Secret_Sharing">Shamir's Secret Sharing</a> and only a few trusted employees have a <i>share</i> of the key. This ensures that no single employee can access your data on their own.
  </p>

  <p>
    We process and store sensitive data in the following locations:
  </p>

  <table>
    <thead>
      <tr>
        <th width="210">Company</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
      <tr>
        <td>
          <a target="_blank" rel="nofollow" href="https://aws.amazon.com/ec2/">Amazon Web Services</a><br>
          Elastic Compute Cloud (EC2)<br>
          <i>Germany &amp; Ireland</i>
        </td>
        <td>
          We receive, process and store all our data in two AWS EC2 regions within the European Union. Sensitive data is encrypted with AES-256-GCM.
        </td>
      </tr>
      <tr>
        <td>
          <a target="_blank" rel="nofollow" href="https://aws.amazon.com/s3/">Amazon Web Services</a><br>
          Simple Storage Service (S3)<br>
          <i>European Union</i>
        </td>
        <td>
          We continuously make backups. Backups are encrypted and stored for 365 days in Amazon S3 within the European Union.
        </td>
      </tr>
      <tr>
        <td>
          <a target="_blank" rel="nofollow" href="https://cloud.google.com/">Google Cloud</a><br>
          Google Compute Engine (GCE)<br>
          <i>Germany</i>
        </td>
        <td>
          GCE is our fallback hosting provider. We do not use this environment unless necessary due to technical issues at AWS or DoS attacks.
        </td>
      </tr>
    </tbody>
  </table>

  <p>
    We share some transaction data with your acquiring bank and the 3-D Secure network. This is limited to the following trusted partners:
  </p>

  <table>
    <thead>
      <tr>
        <th width="140">Company</th>
        <th>Description</th>
        <th>Data</th>
      </tr>
    </thead>
    <tbody>
      <tr>
        <td>Nets Denmark A/S</td>
        <td>
          Nets is an acquiring bank with a pan-European license.
        </td>
        <td>
          Transaction data.<sup><a href="#ref-2">[2]</a></sup>
        </td>
      </tr>
      <tr>
        <td>Clearhaus A/S</td>
        <td>
          Clearhaus is an acquiring bank with a pan-European license.
        </td>
        <td>
          Transaction data and the IP address of the cardholder.<sup><a href="#ref-3">[3]</a></sup>
        </td>
      </tr>
      <tr>
        <td>3dsecure.io</td>
        <td>
          <a target="_blank" href="https://www.3dsecure.io/">3dsecure.io</a> is a 3-D Secure MPI by Clearhaus.
        </td>
        <td>
          Transaction data and the IP address of the cardholder.<sup><a href="#ref-4">[4]</a></sup>
        </td>
      </tr>
    </tbody>
  </table>

  <h3 id="software-security">Software security</h3>
  <p>
    When we started Scanpay, we decided to build our payment platform from scratch, in the programming language C. From the very beginning, the emphasis has been on developing a secure, stable and efficient platform, with a small and auditable code base. To this end, we developed a key-value database system, that is immune to many attack vectors, including SQL injections.
  </p>
  <p>
    Most security breaches occur because of vulnerabilities in third-party software. For this reason, we use very little third-party software. Here is a list of third-party software that we use and trust:
  </p>

  <table>
    <thead>
      <tr>
        <th width="120">Software</th>
        <th>Description</th>
        <th width="70">Risk</th>
        <th width="70">Impact</th>
      </tr>
    </thead>
    <tbody>
      <tr>
        <td><a target="_blank" href="https://www.gentoo.org/">Gentoo Linux</a></td>
        <td>
          Source-based Linux distribution
        </td>
        <td>Very low</td>
        <td>High</td>
      </tr>
      <tr>
        <td><a target="_blank" href="https://nginx.org/en/">NGINX</a></td>
        <td>
          Web server and reverse proxy
        </td>
        <td>Low</td>
        <td>Medium</td>
      </tr>
      <tr>
        <td><a target="_blank" href="https://nginx.org/en/">NAXSI</a></td>
        <td>
          NGINX Web Application Firewall (WAF)
        </td>
        <td>Low</td>
        <td>Very low</td>
      </tr>
      <tr>
        <td><a target="_blank" href="https://www.openssl.org/">OpenSSL</a></td>
        <td>
          TLS and crypto library
        </td>
        <td>Medium</td>
        <td>Medium</td>
      </tr>
      <tr>
        <td><a target="_blank" href="https://www.wireguard.com/">WireGuard</a></td>
        <td>
          Fast and secure kernelspace VPN <sup><a href="#ref-5">[5]</a></sup>
        </td>
        <td>Medium</td>
        <td>Very low</td>
      </tr>
    </tbody>
  </table>

  <p>
    We continuously monitor and scan our systems for vulnerabilities and, in accordance with PCI DSS, we regularly perform ASV scans and pentesting.
  </p>

  <h2 id="transmission-security">Transmission security</h2>

  <div style="float: right; margin-left: 50px;">
    <a target="_blank" href="https://www.ssllabs.com/ssltest/analyze.html?d=betal.scanpay.dk&latest">
      <img class="picture" width="260" src="/img/ssllabs.png">
    </a>
    <div style="font-size: 12px; color: #777; text-align: center; font-style: italic; margin-top: 6px;">
      2019 Q4 SSL report from ssllabs.com
    </div>
  </div>

  <p>
    For security reasons, we only support HTTPS with <code class="code">TLSv1.2</code> and <code class="code">TLSv1.3</code> on port 443. We only support Elliptic Curve Cryptography (ECC) with the following cipher suites:
  </p>

  <ul>
    <li>ECDHE-ECDSA-AES128-GCM-SHA256</li>
    <li>ECDHE-ECDSA-AES256-GCM-SHA384</li>
    <li>ECDHE-ECDSA-AES128-CBC-SHA256</li>
    <li>ECDHE-ECDSA-AES256-CBC-SHA384</li>
    <li>ECDHE-ECDSA-AES128-CBC-SHA</li>
  </ul>

  <p>
    We support HSTS preload, DNS CAA and other security features. You can view a SSL/TLS report <a href="https://www.ssllabs.com/ssltest/analyze.html?d=betal.scanpay.dk">here</a>.
  </p>

  <h3 id="request-authentication">Request authentication</h3>
  <p>
    Before you can use our platform, you must have an API key, which is a unique key used to authenticate API requests. API keys contain a shopid and a randomly generated code, i.e. <code class="code">shopid:code</code>. You can generate an API key in our dashboard after you have created a shop.
  </p>

  <p>
    API requests are authenticated with HTTP Basic Authentication with your API key:

    <code class="pcode"><span class="hljs-string">"Authorization: Basic "</span> + <span class="hljs-built_in">base64_encode(</span>apikey<span class="hljs-built_in">)</span></code>
  </p>
</section>

<hr>

<h3 id="footnotes">Footnotes</h3>
<ul class="citations">
  <li id="ref-1">
    [1] PCI DSS is a security standard for businesses that store, process or transmit credit cards. Since 2017, we have completed two level 1 certifications and two SAQ D certifications. You can view our current AOC <a target="_blank" rel="nofollow" href="https://scanpay.dk/pdf/AOC.pdf">here</a>.
  </li>
  <li id="ref-2">
    [2] This includes cardholder data, amount, currency and text-on-statement.
  </li>
  <li id="ref-3">
    [3] <a href="https://docs.gateway.clearhaus.com/#authorizations" target="_blank">https://docs.gateway.clearhaus.com/#authorizations</a>
  </li>
  <li id="ref-4">
    [4] <a href="https://docs.3dsecure.io/#get-enrollment-status" target="_blank">https://docs.3dsecure.io/#get-enrollment-status</a>
  </li>
  <li id="ref-5">
    [6] We use WireGuard for internal communication between Scanpay servers.
  </li>
</ul>
